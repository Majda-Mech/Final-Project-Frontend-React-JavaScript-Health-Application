{"ast":null,"code":"var _jsxFileName = \"/Users/mechdazariouh/WebstormProjects/frontend-eindopdracht/src/components/context/AuthContext.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useEffect, useState } from 'react';\nimport { useNavigate } from \"react-router-dom\";\nimport jwtDecode from \"jwt-decode\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext({});\nfunction AuthContextProvider(_ref) {\n  _s();\n  let {\n    children\n  } = _ref;\n  const [auth, setAuth] = useState({\n    isAuth: false,\n    user: null,\n    status: 'pending'\n  });\n  const navigate = useNavigate();\n  useEffect(() => {\n    const storedToken = localStorage.getItem('token');\n    if (storedToken) {\n      const decodedToken = jwtDecode(storedToken);\n      if (Math.floor(Date.now() / 1000) < decodedToken.exp) {\n        console.log(\"De gebruiker is NOG STEEDS ingelogd ðŸ”“\");\n        void fetchData(storedToken, decodedToken.sub);\n      } else {\n        console.log(\"De token is verlopen\");\n        localStorage.removeItem('token');\n      }\n    } else {\n      setAuth({\n        ...auth,\n        isAuth: false,\n        user: null,\n        status: \"done\"\n      });\n    }\n  }, []);\n  function login(jwt) {\n    console.log(\"De gebruiker is ingelogd ðŸ”“\");\n    console.log(jwt);\n    localStorage.setItem('token', jwt);\n    const decodedToken = jwtDecode(jwt);\n    console.log(decodedToken);\n    void fetchData(jwt, decodedToken.sub, '/search');\n  }\n  async function fetchData(jwt, id, redirect) {\n    try {\n      const response = await axios.get(`http://localhost:8081/users/${id}`, {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${jwt}`\n        }\n      });\n      console.log(response);\n      setAuth({\n        ...auth,\n        isAuth: true,\n        user: {\n          username: response.data.username,\n          email: response.data.email,\n          id: response.data.id\n        },\n        status: 'done'\n      });\n      if (redirect) {\n        navigate(redirect);\n      }\n    } catch (e) {\n      console.error(e);\n      setAuth({\n        ...auth,\n        status: 'done'\n      });\n    }\n  }\n  function logout() {\n    console.log(\"De gebruiker is uitgelogd ðŸ”’\");\n    localStorage.removeItem('token');\n    setAuth({\n      ...auth,\n      isAuth: false,\n      user: null,\n      status: \"done\"\n    });\n    navigate('/');\n  }\n  const data = {\n    login: login,\n    logout: logout,\n    isAuth: auth.isAuth,\n    user: auth.user,\n    status: auth.status\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: data,\n    children: auth.status === 'done' ? children : /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 50\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 110,\n    columnNumber: 9\n  }, this);\n}\n_s(AuthContextProvider, \"lxW+p6tpqa53cSw0AejT28jvcVo=\", false, function () {\n  return [useNavigate];\n});\n_c = AuthContextProvider;\nexport default AuthContextProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["React","createContext","useEffect","useState","useNavigate","jwtDecode","axios","jsxDEV","_jsxDEV","AuthContext","AuthContextProvider","_ref","_s","children","auth","setAuth","isAuth","user","status","navigate","storedToken","localStorage","getItem","decodedToken","Math","floor","Date","now","exp","console","log","fetchData","sub","removeItem","login","jwt","setItem","id","redirect","response","get","headers","Authorization","username","data","email","e","error","logout","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/mechdazariouh/WebstormProjects/frontend-eindopdracht/src/components/context/AuthContext.js"],"sourcesContent":["import React, {createContext, useEffect, useState} from 'react';\nimport {useNavigate} from \"react-router-dom\";\nimport jwtDecode from \"jwt-decode\";\nimport axios from \"axios\";\n\nexport const AuthContext = createContext({});\n\n\nfunction AuthContextProvider({children}) {\n\n    const [auth, setAuth] = useState({\n        isAuth: false,\n        user: null,\n        status: 'pending'\n    });\n\n    const navigate = useNavigate()\n\n    useEffect(() => {\n        const storedToken = localStorage.getItem('token')\n\n        if (storedToken) {\n            const decodedToken = jwtDecode(storedToken)\n\n            if (Math.floor(Date.now() / 1000) < decodedToken.exp) {\n                console.log( \"De gebruiker is NOG STEEDS ingelogd ðŸ”“\" )\n                void fetchData(storedToken, decodedToken.sub)\n            } else  {\n                console.log( \"De token is verlopen\" )\n                localStorage.removeItem( 'token' )\n            }\n        } else {\n            setAuth( {\n                ...auth,\n                isAuth: false,\n                user: null,\n                status: \"done\"\n            } )\n        }\n    }, [] )\n\n    function login(jwt) {\n        console.log( \"De gebruiker is ingelogd ðŸ”“\" )\n        console.log(jwt);\n        localStorage.setItem('token', jwt);\n        const decodedToken = jwtDecode(jwt)\n\n        console.log(decodedToken);\n        void fetchData(jwt, decodedToken.sub, '/search')\n    }\n\n    async function fetchData(jwt, id ,redirect) {\n        try {\n            const response = await axios.get(`http://localhost:8081/users/${id}`, {\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    Authorization: `Bearer ${jwt}`,\n                }\n            })\n            console.log(response)\n\n            setAuth({\n                ...auth,\n                isAuth: true,\n                user: {\n                    username: response.data.username,\n                    email: response.data.email,\n                    id: response.data.id,\n                },\n                status: 'done'\n            });\n            if (redirect) {\n                navigate(redirect)\n            }\n\n        } catch (e) {\n            console.error(e)\n            setAuth({\n                ...auth,\n                status: 'done'\n            })\n        }\n    }\n\n\n    function logout() {\n        console.log( \"De gebruiker is uitgelogd ðŸ”’\" )\n        localStorage.removeItem( 'token' )\n        setAuth( {\n            ...auth,\n            isAuth: false,\n            user: null,\n            status: \"done\"\n        } )\n        navigate('/');\n    }\n\n\n    const data = {\n\n        login: login,\n        logout: logout,\n        isAuth: auth.isAuth,\n        user: auth.user,\n        status: auth.status\n\n    };\n\n    return (\n        <AuthContext.Provider value={data}>\n            {auth.status === 'done' ? children : <p>Loading...</p>}\n        </AuthContext.Provider>\n    )\n}\n\nexport default AuthContextProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}